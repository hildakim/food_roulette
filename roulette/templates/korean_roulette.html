{% extends 'base.html' %}
{% block content %}
{% load static %}
<link rel="stylesheet" href="{%static 'css/koreamenu.css' %}">

<body>
  <div class="main">
    <div class="category">{{category}}</div>

      <div class="pointer" style="display:flex; justify-content: center;">
        <img src="../static/img/arrow.png" style="height: 50px;">
      </div>
    
    <!--ë£°ë ›-->
    <div class="container">
      <div class="roulette">
        <div class="fill fill_1"></div>
        <div class="fill fill_2"></div>
        <div class="fill fill_3"></div>
        <div class="fill fill_4"></div>
        <div class="fill fill_5"></div>
        <div class="fill fill_6"></div>  
        <div class="fill fill_7"></div>  
        <div class="fill fill_8"></div>  
        <!-- content -->
        <div class="content content_1">ì°Œê°œ</div>
        <div class="content content_2">êµ­ë°¥</div>
        <div class="content content_3">ìŒˆë°¥</div>
        <div class="content content_4">ë°±ë°˜</div>
        <div class="content content_5">ì¡±ë°œ&ë³´ìŒˆ</div>
        <div class="content content_6">ì œìœ¡ë³¶ìŒ</div>
        <div class="content content_7">ì‚¼ê²¹ì‚´</div>
        <div class="content content_8">ì°œë‹­</div>
      </div>
      <div style="display: flex; justify-content:space-around;">
        <button class="trigger">ë½‘ê¸°</button>
      </div>
      <div style="display: flex; justify-content:space-around;" class="print_menu">
        <p>ì˜¤ëŠ˜ì€... <a href="#" class="link"><span id="menu_f"></span></a></p>
      </div>
    </div>
    <div class="btnToHome">
      <a href="{%url 'roulette:mainpage' %}">ì²˜ìŒìœ¼ë¡œğŸ </a>
    </div>
  </div>

  <script>
    const roulette = document.querySelector(".roulette");
    const content=document.querySelectorAll(".roulette .fill .content");
    const trigger = document.querySelector(".trigger");
    const ROULETTE_DATA=['ì°Œê°œ','êµ­ë°¥','ìŒˆë°¥','ë°±ë°˜','ì¡±ë°œ&ë³´ìŒˆ','ì œìœ¡ë³¶ìŒ','ì‚¼ê²¹ì‚´','ì°œë‹­'];
    var url="{% url 'roulette:map' 123 %}"
    const BASE_ROTATE_DEG=7200;
    const loopAnimationOptions={
      fill:'forwards',
      duration:3000,
      easing:'ease-in-out'
    }
    trigger.addEventListener("click",onClickTrigger);
    function onClickTrigger(e) {
      const selectedIdx=parseInt(Math.random()*ROULETTE_DATA.length);
      const additionalDeg=-(360/ROULETTE_DATA.length)*selectedIdx-22.5;
      var resultMenu=ROULETTE_DATA[selectedIdx];
      const totalDeg=BASE_ROTATE_DEG+additionalDeg;
      const loopAnimation=[
        {transform:'rotate(0deg)'},
        {transform:`rotate(${totalDeg}deg)`}
      ];
      roulette.animate(loopAnimation,loopAnimationOptions);

      roulette.animate(loopAnimation,loopAnimationOptions);

      selected_menu = document.getElementById('menu_f');
      setTimeout(() => {
        trigger.innerHTML="ë‹¤ì‹œ ëŒë¦¬ê¸°";
        selected_menu.innerHTML=`${resultMenu} (ğŸ‘ˆí´ë¦­!)`;
      }, 3000);
      // document.getElementById('menu_f').innerHTML=resultMenu;
      $('.link').attr('href',url.replace('123', resultMenu));
    }


  </script>
</body>
{% endblock %}